<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì„¸íŠ¹ì •</title>
    <style>
        body {
            font-family: 'Pretendard', -apple-system, BlinkMacSystemFont, system-ui, Roboto, 'Helvetica Neue', 'Segoe UI', 'Apple SD Gothic Neo', 'Noto Sans KR', 'Malgun Gothic', sans-serif;
            background: #f8f9fa;
            margin: 0;
            padding: 20px;
            min-height: 200vh; /* ì„¸ë¡œ ì‚¬ì´ì¦ˆ ë‘ ë°°ë¡œ ëŠ˜ë¦¼ */
            position: relative;
            font-size: 20px; /* í°íŠ¸ í¬ê¸° ê³ ì • */
        }
        h1 {
            font-size: 32px;
            color: #2c3e50;
            margin-bottom: 30px;
            text-align: center;
        }
        .tab-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        .tab-button {
            padding: 12px 24px;
            font-size: 20px; /* í°íŠ¸ í¬ê¸° ê³ ì • */
            cursor: pointer;
            background-color: #e9ecef;
            border: none;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        .tab-button.active {
            background-color: #3498db;
            color: white;
        }
        .tab-button:hover {
            background-color: #ced4da;
        }
        .button-container {
            display: flex;
            justify-content: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        .button-container button {
            padding: 12px 24px;
            font-size: 20px; /* í°íŠ¸ í¬ê¸° ê³ ì • */
            cursor: pointer;
            background-color: #3498db;
            color: white;
            border: none;
            border-radius: 8px;
            transition: all 0.3s ease;
        }
        .button-container button:hover {
            background-color: #2980b9;
        }
        #container {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 20px;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        .block {
            background: white;
            padding: 25px;
            border-radius: 15px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            width: 100%;
            transition: transform 0.3s ease;
            position: relative;
        }
        .block:hover {
            transform: translateY(-5px);
        }
        .title-input {
            padding: 12px 20px;
            margin-bottom: 15px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            width: calc(100% - 40px);
            transition: border-color 0.3s ease;
            font-size: 20px; /* í°íŠ¸ í¬ê¸° ê³ ì • */
        }
        .title-input:focus {
            outline: none;
            border-color: #3498db;
        }
        .text-area {
            padding: 15px 20px;
            border: 2px solid #e9ecef;
            border-radius: 8px;
            width: calc(100% - 40px);
            min-height: 300px;
            resize: vertical;
            transition: border-color 0.3s ease;
            overflow: hidden;
            font-size: 20px; /* í°íŠ¸ í¬ê¸° ê³ ì • */
        }
        .text-area:focus {
            outline: none;
            border-color: #3498db;
        }
        .byte-count {
            color: #7f8c8d;
            margin-top: 10px;
            text-align: right;
            font-size: 18px; /* í°íŠ¸ í¬ê¸° ê³ ì • */
        }
        .save-status {
            font-size: 16px;
            color: #666;
            text-align: center;
            margin: 10px 0;
            height: 20px;
        }
        .warning-message {
            font-size: 14px;
            color: #e74c3c;
            text-align: center;
            margin: 10px 0;
        }
        .visitor-counter {
            font-size: 14px;
            color: #666;
            text-align: center;
            margin: 10px 0;
        }
        .footer {
            font-size: 14px;
            color: #666;
            text-align: center;
            margin-top: 30px;
            padding-bottom: 20px;
        }
        .delete-button {
            position: absolute;
            top: 10px;
            right: 10px;
            background-color: #e74c3c;
            color: white;
            border: none;
            border-radius: 5px;
            padding: 5px 10px;
            cursor: pointer;
            font-size: 16px; /* í°íŠ¸ í¬ê¸° ê³ ì • */
        }
        .delete-button:hover {
            background-color: #c0392b;
        }
        .grade-1 {
            background-color: #f8d7da;
        }
        .grade-2 {
            background-color: #d4edda;
        }
        .grade-3 {
            background-color: #d1ecf1;
        }
    </style>
</head>
<body>
    <h1>ì„¸ë¶€ëŠ¥ë ¥ë° íŠ¹ê¸°ì‚¬í•­ ì •ë¦¬ ğŸ“</h1>
    <div class="tab-container">
        <button class="tab-button active" data-grade="1">1í•™ë…„</button>
        <button class="tab-button" data-grade="2">2í•™ë…„</button>
        <button class="tab-button" data-grade="3">3í•™ë…„</button>
    </div>
    <div class="button-container">
        <button id="addBlock">+ì¶”ê°€</button>
        <button id="saveData">ì €ì¥</button>
        <button id="downloadData">ë°±ì—…</button>
        <button id="uploadData">ë°±ì—… íŒŒì¼ ì—…ë¡œë“œ</button>
    </div>
    <div class="save-status" id="saveStatus"></div>
    <div class="warning-message">
        ë°ì´í„°ëŠ” ë¸Œë¼ìš°ì €ì— ì €ì¥ë˜ì§€ë§Œ, ë§Œì•½ì„ ìœ„í•´ ê¼­ ë°±ì—…ì„ í•˜ì‹œê¸° ë°”ëë‹ˆë‹¤.
    </div>
    <div id="container"></div>
    <div class="footer"><img src="https://hits.seeyoufarm.com/api/count/incr/badge.svg?url=https%3A%2F%2Fkimsj5025.github.io%2Fsetuksaver%2F&count_bg=%2394BC75&title_bg=%23555555&icon=&icon_color=%23000000&title=%EB%B0%A9%EB%AC%B8%EC%9E%90+%EC%88%98&edge_flat=true"/><br>made by kimCastleOwner</div>

    <script>
        let currentGrade = '1';
        const gradeData = {
            '1': [],
            '2': [],
            '3': []
        };
        let todayVisitor = 0;
        let totalVisitor = 0;

        function showSaveStatus(message) {
            const status = document.getElementById('saveStatus');
            status.textContent = message;
            setTimeout(() => status.textContent = '', 1000);
        }

        function saveBlocksToLocalStorage() {
            const blocks = [];
            document.querySelectorAll(".block").forEach(block => {
                blocks.push({
                    title: block.querySelector(".title-input").value,
                    text: block.querySelector(".text-area").value
                });
            });
            gradeData[currentGrade] = blocks;
            localStorage.setItem("gradeData", JSON.stringify(gradeData));
            localStorage.setItem("lastGrade", currentGrade);
            showSaveStatus('ì €ì¥ ì™„ë£Œ!');
        }

        function loadBlocksFromLocalStorage() {
            const data = localStorage.getItem("gradeData");
            if (data) {
                Object.assign(gradeData, JSON.parse(data));
                loadGradeBlocks(currentGrade);
            }
            const lastGrade = localStorage.getItem("lastGrade");
            if (lastGrade) {
                currentGrade = lastGrade;
                document.querySelectorAll(".tab-button").forEach(btn => btn.classList.remove("active"));
                document.querySelector(`.tab-button[data-grade="${currentGrade}"]`).classList.add("active");
                loadGradeBlocks(currentGrade);
            }
        }

        function loadGradeBlocks(grade) {
            const container = document.getElementById("container");
            container.innerHTML = '';
            gradeData[grade].forEach(data => addBlock(data.title, data.text));
        }

        function addBlock(title = "", text = "") {
            const block = document.createElement("div");
            block.classList.add("block", `grade-${currentGrade}`);

            const titleInput = document.createElement("input");
            titleInput.type = "text";
            titleInput.placeholder = "ê³¼ëª©ëª…";
            titleInput.classList.add("title-input");
            titleInput.value = title;

            const textArea = document.createElement("textarea");
            textArea.placeholder = "ì„¸íŠ¹ ë‚´ìš©";
            textArea.classList.add("text-area");
            textArea.value = text;

            const byteCount = document.createElement("div");
            byteCount.classList.add("byte-count");
            byteCount.textContent = new Blob([text]).size + " ë°”ì´íŠ¸";

            const deleteButton = document.createElement("button");
            deleteButton.classList.add("delete-button");
            deleteButton.textContent = "ì‚­ì œ";
            deleteButton.addEventListener("click", () => {
                block.remove();
                saveBlocksToLocalStorage();
            });

            textArea.addEventListener("input", () => {
                byteCount.textContent = new Blob([textArea.value]).size + " ë°”ì´íŠ¸";
                saveBlocksToLocalStorage();
            });

            titleInput.addEventListener("input", saveBlocksToLocalStorage);

            block.appendChild(titleInput);
            block.appendChild(textArea);
            block.appendChild(byteCount);
            block.appendChild(deleteButton);
            document.getElementById("container").appendChild(block);
        }

        function downloadData() {
            const dataStr = JSON.stringify(gradeData);
            const dataBlob = new Blob([dataStr], { type: 'application/json' });
            const url = URL.createObjectURL(dataBlob);
            const a = document.createElement('a');
            a.href = url;
            a.download = 'gradeData.json';
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        function uploadData(event) {
            const file = event.target.files[0];
            const reader = new FileReader();
            reader.onload = function(e) {
                const data = JSON.parse(e.target.result);
                Object.assign(gradeData, data);
                loadGradeBlocks(currentGrade);
                saveBlocksToLocalStorage();
            };
            reader.readAsText(file);
        }

        function updateVisitorCount() {
            const today = new Date().toDateString();
            const lastVisit = localStorage.getItem('lastVisit');
            if (lastVisit !== today) {
                todayVisitor = 0;
                localStorage.setItem('lastVisit', today);
            }
            todayVisitor++;
            totalVisitor = parseInt(localStorage.getItem('totalVisitor') || 0) + 1;
            localStorage.setItem('totalVisitor', totalVisitor);
            document.getElementById('todayVisitor').textContent = todayVisitor;
            document.getElementById('totalVisitor').textContent = totalVisitor;
        }

        document.getElementById("addBlock").addEventListener("click", () => addBlock());
        document.getElementById("saveData").addEventListener("click", saveBlocksToLocalStorage);
        document.getElementById("downloadData").addEventListener("click", downloadData);
        document.getElementById("uploadData").addEventListener("click", () => document.getElementById('fileInput').click());

        const fileInput = document.createElement('input');
        fileInput.type = 'file';
        fileInput.id = 'fileInput';
        fileInput.style.display = 'none';
        fileInput.addEventListener('change', uploadData);
        document.body.appendChild(fileInput);

        document.querySelectorAll(".tab-button").forEach(button => {
            button.addEventListener("click", () => {
                document.querySelectorAll(".tab-button").forEach(btn => btn.classList.remove("active"));
                button.classList.add("active");
                currentGrade = button.dataset.grade;
                loadGradeBlocks(currentGrade);
            });
        });

        window.onload = () => {
            loadBlocksFromLocalStorage();
            updateVisitorCount();
        };
    </script>
</body>
</html>
